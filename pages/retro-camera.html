<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ANTHOLOGY CAM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&family=Montserrat:wght@300;400;600&family=Noto+Serif+SC:wght@300;500;700&display=swap" rel="stylesheet">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              serif: ['"Cormorant Garamond"', 'serif'],
              sans: ['"Montserrat"', 'sans-serif'],
              sc: ['"Noto Serif SC"', 'serif'],
            },
            colors: {
              paper: '#fdfbf7',
              ink: '#2c2c2c',
              accent: '#8c3a3a' 
            },
            boxShadow: {
              'book': '0 2px 5px rgba(0,0,0,0.05), 0 20px 40px -5px rgba(0,0,0,0.1)',
            },
            animation: {
              'fade-in': 'fadeIn 0.8s ease-out forwards',
            },
            keyframes: {
              fadeIn: { '0%': { opacity: 0 }, '100%': { opacity: 1 } }
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #f4f1ea;
        color: #2c2c2c;
        overflow: hidden;
        background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23d6d3cd' fill-opacity='0.4'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' /%3E%3C/g%3E%3C/svg%3E");
      }
      ::-webkit-scrollbar { display: none; }
      .cursor-wait { cursor: wait; }

      @keyframes pulse-dot {
        0%, 100% { transform: translateY(0) scale(0.8); opacity: 0.3; }
        50% { transform: translateY(-2px) scale(1.1); opacity: 1; }
      }
      .dot-pulse-1 { animation: pulse-dot 1.4s infinite ease-in-out; }
      .dot-pulse-2 { animation: pulse-dot 1.4s infinite ease-in-out 0.15s; }
      .dot-pulse-3 { animation: pulse-dot 1.4s infinite ease-in-out 0.3s; }
      .dot-pulse-4 { animation: pulse-dot 1.4s infinite ease-in-out 0.45s; }
      .dot-pulse-5 { animation: pulse-dot 1.4s infinite ease-in-out 0.6s; }
    </style>
    
    <!-- UMD Scripts -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/html2canvas@1.4.1/dist/html2canvas.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Google Generative AI -->
    <script type="importmap">
      {
        "imports": {
          "@google/generative-ai": "https://esm.sh/@google/generative-ai@0.11.3"
        }
      }
    </script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
      import { GoogleGenerativeAI } from "@google/generative-ai";

      // --- GLOBALS ---
      const { useState, useEffect, useRef } = React;
      const { motion, AnimatePresence } = window.Motion;

      // --- ICONS ---
      const IconWrapper = ({ children, size = 24, className, ...props }) => (
        <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
      );
      const Download = (props) => <IconWrapper {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="7 10 12 15 17 10" /><line x1="12" x2="12" y1="15" y2="3" /></IconWrapper>;
      const Trash2 = (props) => <IconWrapper {...props}><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" /><line x1="10" x2="10" y1="11" y2="17" /><line x1="14" x2="14" y1="11" y2="17" /></IconWrapper>;
      const RefreshCw = (props) => <IconWrapper {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" /><path d="M21 3v5h-5" /><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" /><path d="M8 16H3v5" /></IconWrapper>;
      const Key = (props) => <IconWrapper {...props}><path d="m21 2-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0 3 3L22 7l-3-3m-3.5 3.5L19 4" /></IconWrapper>;
      const Check = (props) => <IconWrapper {...props}><polyline points="20 6 9 17 4 12" /></IconWrapper>;

      // --- SERVICES ---
      const generatePhotoCaption = async ({ imageBase64, language, apiKey }) => {
        if (!apiKey) return "Please set API Key.";
        try {
          const genAI = new GoogleGenerativeAI(apiKey);
          const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash" });
          const cleanBase64 = imageBase64.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/, '');
          
          const prompt = `
            Analyze this image. 
            Write a caption as if it is a fragment from a novel or a line of poetry found in an old book.
            Bilingual (English & Chinese).
            Theme: Memory, Time, The Unspoken, Daily Epiphanies.
            
            FORMAT RULES:
            1. Use markers for styling (simple is better for layout):
               <text> for emphasized/italic words.
               {text} for strong/bold words.
               *text* for a subtle highlight.
            2. Do not use too many markers. Keep it elegant.
            3. Max 25 words. 
            
            Example:
            It was the <light> that changed everything.
            *Afternoon* / 午后
            {Silence} was the only answer.
          `;
          
          const result = await model.generateContent([prompt, { inlineData: { data: cleanBase64, mimeType: "image/png" } }]);
          const response = await result.response;
          return response.text().trim() || "The <Silence> / 沉默";
        } catch (error) {
          console.error(error);
          return "Error <404> / 丢失";
        }
      };

      // --- COMPONENTS ---

      const LoadingAnimation = () => {
        return (
          <div className="flex items-center justify-center gap-1.5 py-2 opacity-50">
             <motion.div 
               className="w-1.5 h-1.5 bg-stone-800 rounded-full"
               animate={{ y: [0, -2, 0], opacity: [0.3, 1, 0.3], scale: [0.8, 1.1, 0.8] }}
               transition={{ duration: 1.4, repeat: Infinity, ease: "easeOut", delay: 0 }}
             />
             <motion.div 
               className="w-1.5 h-1.5 bg-stone-800 rounded-full"
               animate={{ y: [0, -2, 0], opacity: [0.3, 1, 0.3], scale: [0.8, 1.1, 0.8] }}
               transition={{ duration: 1.4, repeat: Infinity, ease: "easeOut", delay: 0.15 }}
             />
             <motion.div 
               className="w-1.5 h-1.5 bg-stone-800 rounded-full"
               animate={{ y: [0, -2, 0], opacity: [0.3, 1, 0.3], scale: [0.8, 1.1, 0.8] }}
               transition={{ duration: 1.4, repeat: Infinity, ease: "easeOut", delay: 0.3 }}
             />
             <motion.div 
               className="w-1.5 h-1.5 bg-stone-800 rounded-full"
               animate={{ y: [0, -2, 0], opacity: [0.3, 1, 0.3], scale: [0.8, 1.1, 0.8] }}
               transition={{ duration: 1.4, repeat: Infinity, ease: "easeOut", delay: 0.45 }}
             />
             <motion.div 
               className="w-1.5 h-1.5 bg-stone-800 rounded-full"
               animate={{ y: [0, -2, 0], opacity: [0.3, 1, 0.3], scale: [0.8, 1.1, 0.8] }}
               transition={{ duration: 1.4, repeat: Infinity, ease: "easeOut", delay: 0.6 }}
             />
          </div>
        );
      };

      const PoeticText = ({ text }) => {
        if (!text) return <LoadingAnimation />;
        const lines = text.split(/\n/);
        return (
          <motion.div 
            initial={{ opacity: 0 }} 
            animate={{ opacity: 1 }} 
            transition={{ duration: 0.8 }}
            className="flex flex-col gap-1.5 items-center w-full"
          >
            {lines.map((line, i) => (
              <div key={i} className="text-center leading-relaxed break-words w-full">
                 {renderLine(line)}
              </div>
            ))}
          </motion.div>
        );
      };

      const renderLine = (line) => {
        const parts = line.split(/([<{*].*?[>}\*])/g);
        return parts.map((part, idx) => {
          if (!part) return null;
          
          if (part.match(/^<.*>$/)) {
            return <span key={idx} className="font-serif italic text-[15px] text-black mx-0.5">{part.slice(1,-1)}</span>;
          }
          if (part.match(/^\{.*\}$/)) {
             return <span key={idx} className="font-sans font-bold text-[10px] uppercase tracking-widest mx-0.5 text-stone-800">{part.slice(1,-1)}</span>;
          }
          if (part.match(/^\*.*\*$/)) {
             return <span key={idx} className="font-serif text-[14px] mx-0.5 border-b-2 border-yellow-200/80 px-0.5">{part.slice(1,-1)}</span>;
          }
          return <span key={idx} className="font-serif text-[13px] text-stone-600">{part}</span>;
        });
      };

      const PhotoCard = ({ photo, onDelete, onUpdateCaption, onDragEnd, browserLang, apiKey }) => {
        const [isHovered, setIsHovered] = useState(false);
        const [isEditing, setIsEditing] = useState(false);
        const [editText, setEditText] = useState(photo.caption);
        const [isRegenerating, setIsRegenerating] = useState(false);
        const cardRef = useRef(null);

        const figNum = photo.id.slice(-3);
        const dateStr = new Date(photo.timestamp).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }).toUpperCase();

        const handleDownload = async (e) => {
          e.stopPropagation();
          if (cardRef.current) {
            const tools = cardRef.current.querySelector('.photo-tools');
            if (tools) tools.style.display = 'none';
            
            try {
                const canvas = await html2canvas(cardRef.current, { 
                    scale: 4, 
                    backgroundColor: null, 
                    useCORS: true,
                    logging: false,
                    allowTaint: true,
                });
                
                const link = document.createElement('a');
                link.download = `Anthology-Fig${figNum}.png`;
                link.href = canvas.toDataURL('image/png', 1.0);
                link.click();
            } finally {
                if (tools) tools.style.display = ''; 
            }
          }
        };

        const handleRegenerate = async (e) => {
          e.stopPropagation();
          if (!apiKey) { alert("API KEY REQUIRED"); return; }
          setIsRegenerating(true);
          const newCaption = await generatePhotoCaption({ imageBase64: photo.imageUrl, language: browserLang, apiKey });
          onUpdateCaption(photo.id, newCaption);
          setEditText(newCaption);
          setIsRegenerating(false);
        };

        return (
          <motion.div
            ref={cardRef}
            initial={{ x: photo.x, y: photo.y, rotate: (Math.random() * 4 - 2), scale: 0.9, opacity: 0 }}
            animate={{ x: photo.x, y: photo.y, rotate: photo.rotation, scale: 1, opacity: 1 }}
            drag dragMomentum={false}
            onDragEnd={(_, info) => onDragEnd(photo.id, photo.x + info.offset.x, photo.y + info.offset.y)}
            onHoverStart={() => setIsHovered(true)}
            onHoverEnd={() => setIsHovered(false)}
            className="absolute flex flex-col bg-[#fdfdfd] shadow-book cursor-grab active:cursor-grabbing select-none"
            style={{ width: '280px', padding: '20px 20px 40px 20px', zIndex: isHovered ? 50 : 10 }}
          >
            {/* Header: Fig. Number */}
            <div className="flex justify-between items-center mb-3 border-b border-stone-200 pb-2">
                <span className="font-serif italic text-lg text-stone-800">Fig. {figNum}</span>
                <span className="font-sans text-[9px] uppercase tracking-widest text-stone-400">{dateStr}</span>
            </div>

            {/* Photo: 4:5 Ratio */}
            <div className="w-full aspect-[4/5] relative bg-stone-100 overflow-hidden mb-4">
              <motion.img src={photo.imageUrl} draggable={false} className="w-full h-full object-cover pointer-events-none grayscale-[15%] contrast-[1.05]" 
                initial={{ filter: 'blur(10px) sepia(20%)' }} 
                animate={{ filter: photo.status === 'developed' ? 'blur(0px) sepia(0%)' : 'blur(10px) sepia(20%)' }} 
                transition={{ duration: 2.5 }} 
              />
            </div>

            {/* Caption */}
            <div className="flex flex-col items-center justify-center w-full min-h-[2.5rem]">
               {isEditing ? (
                  <div className="w-full relative" onPointerDown={(e) => e.stopPropagation()}>
                      <textarea value={editText} onChange={(e) => setEditText(e.target.value)} className="w-full font-serif text-sm bg-stone-50 p-2 border border-stone-200 focus:outline-none focus:border-stone-400 transition-colors" rows={3} autoFocus />
                      <button onClick={() => { onUpdateCaption(photo.id, editText); setIsEditing(false); }} className="absolute bottom-1 right-1 text-stone-500 hover:text-stone-800"><Check size={12} /></button>
                  </div>
               ) : (
                  <div onDoubleClick={() => setIsEditing(true)} className="cursor-text w-full px-1">
                     <PoeticText text={photo.caption || (isRegenerating ? "..." : "...")} />
                  </div>
               )}
            </div>

            {/* Tools (Top Right Overlay) */}
            {isHovered && !isEditing && (
              <div className="photo-tools absolute -top-3 -right-3 flex gap-1 z-50">
                 <button onClick={handleDownload} className="w-7 h-7 bg-white rounded-full text-stone-400 hover:text-stone-800 hover:shadow-md transition-all flex items-center justify-center border border-stone-100" title="Collect"><Download size={12} /></button>
                 <button onClick={handleRegenerate} className={`w-7 h-7 bg-white rounded-full text-stone-400 hover:text-stone-800 hover:shadow-md transition-all flex items-center justify-center border border-stone-100 ${isRegenerating ? 'animate-spin' : ''}`} title="Rewrite"><RefreshCw size={12} /></button>
                 <button onClick={() => onDelete(photo.id)} className="w-7 h-7 bg-white rounded-full text-stone-400 hover:text-red-500 hover:shadow-md transition-all flex items-center justify-center border border-stone-100" title="Remove"><Trash2 size={12} /></button>
              </div>
            )}
          </motion.div>
        );
      };

      const App = () => {
        const videoRef = useRef(null);
        const [stream, setStream] = useState(null);
        const [photos, setPhotos] = useState([]);
        const [isThrottled, setIsThrottled] = useState(false);
        const [apiKey, setApiKey] = useState(localStorage.getItem('gemini_api_key') || '');
        const [showApiKeyModal, setShowApiKeyModal] = useState(!localStorage.getItem('gemini_api_key'));
        const browserLang = navigator.language || 'en-US';
        
        const CAMERA_CONTAINER_WIDTH = 300;
        const CAMERA_CONTAINER_HEIGHT = 450;
        const CAMERA_LEFT = 60;
        const CAMERA_BOTTOM = 60;

        useEffect(() => {
          const startCamera = async () => {
            try {
              const mediaStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user', width: { ideal: 1280 } }, audio: false });
              setStream(mediaStream);
              if (videoRef.current) videoRef.current.srcObject = mediaStream;
            } catch (err) { console.error(err); }
          };
          startCamera();
          return () => { if (stream) stream.getTracks().forEach(track => track.stop()); };
        }, []);

        const saveApiKey = (key) => { localStorage.setItem('gemini_api_key', key); setApiKey(key); setShowApiKeyModal(false); };

        const takePhoto = () => {
           if (!videoRef.current || isThrottled) return;
           
           setIsThrottled(true);
           setTimeout(() => setIsThrottled(false), 2000); 

           const video = videoRef.current;
           const canvas = document.createElement('canvas');
           const h = video.videoHeight;
           const w = h * (4/5); 
           const x = (video.videoWidth - w) / 2;
           
           canvas.width = 800; canvas.height = 1000; 
           const ctx = canvas.getContext('2d');
           ctx.translate(canvas.width, 0); ctx.scale(-1, 1);
           ctx.drawImage(video, x, 0, w, h, 0, 0, canvas.width, canvas.height);
           
           const newPhoto = {
             id: Date.now().toString(),
             imageUrl: canvas.toDataURL('image/webp', 0.95),
             caption: '',
             timestamp: Date.now(),
             status: 'developing',
             x: CAMERA_LEFT + 30, 
             y: window.innerHeight - CAMERA_BOTTOM - CAMERA_CONTAINER_HEIGHT, 
             rotation: 0
           };
           
           setPhotos(prev => [...prev, newPhoto]);
           
           setTimeout(() => {
              setPhotos(prev => prev.map(p => p.id === newPhoto.id ? { 
                  ...p, 
                  y: window.innerHeight / 2 - 250, 
                  x: window.innerWidth / 2 - 140, 
                  rotation: (Math.random() * 3 - 1.5) 
              } : p));
           }, 100);

           if (apiKey) {
             generatePhotoCaption({ imageBase64: newPhoto.imageUrl, language: browserLang, apiKey }).then(caption => {
                setPhotos(prev => prev.map(p => p.id === newPhoto.id ? { ...p, caption } : p));
             });
           }
           
           setTimeout(() => {
              setPhotos(prev => prev.map(p => p.id === newPhoto.id ? { ...p, status: 'developed' } : p));
           }, 1500);
        };

        return (
          <div className="w-screen h-screen relative select-none overflow-hidden">
            {/* BACKGROUND */}
            <div className="absolute inset-0 flex items-center justify-center pointer-events-none opacity-[0.03] overflow-hidden">
               <h1 className="text-[18vw] font-serif italic font-black leading-none whitespace-nowrap text-stone-900 tracking-tighter transform -rotate-3">ANTHOLOGY</h1>
            </div>
            <div className="absolute top-8 left-8 pointer-events-none">
               <div className="font-serif italic text-2xl text-stone-800">Anthology.</div>
               <div className="font-sans text-[9px] uppercase tracking-[0.2em] text-stone-400 mt-1">
                  Library of Moments<br/>Vol. 01
               </div>
            </div>

            {/* PHOTO WALL */}
            <div className="absolute inset-0 z-10">
               <AnimatePresence>
                 {photos.map(p => <PhotoCard key={p.id} photo={p} onDelete={id => setPhotos(prev => prev.filter(x => x.id !== id))} onUpdateCaption={(id, c) => setPhotos(prev => prev.map(x => x.id === id ? {...x, caption: c} : x))} onDragEnd={(id, x, y) => setPhotos(prev => prev.map(item => item.id === id ? { ...item, x, y } : item))} browserLang={browserLang} apiKey={apiKey} />)}
               </AnimatePresence>
            </div>

            {/* CAMERA OBJECT */}
            <div 
              className="fixed flex flex-col items-center"
              style={{
                width: `${CAMERA_CONTAINER_WIDTH}px`,
                bottom: `${CAMERA_BOTTOM}px`,
                left: `${CAMERA_LEFT}px`,
                zIndex: 20 
              }}
            >
                <div className="relative w-full bg-[#e4e2dd] rounded-sm shadow-[0_30px_60px_-10px_rgba(0,0,0,0.3)] flex flex-col overflow-hidden group border border-white/50 ring-1 ring-black/5">
                    {/* Lens Branding */}
                    <div className="h-8 flex items-center justify-between px-4 bg-[#efede8] border-b border-[#d6d3cd]">
                         <span className="font-sans text-[7px] tracking-[0.2em] text-stone-400">ANTHOLOGY OPTICS</span>
                         <div className="flex gap-1">
                             <div className="w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                             <div className="w-1.5 h-1.5 rounded-full bg-stone-300"></div>
                         </div>
                    </div>
                    
                    {/* Screen */}
                    <div className="relative w-full aspect-[3/4] bg-black">
                        <video ref={videoRef} autoPlay playsInline muted className="w-full h-full object-cover transform scale-x-[-1] opacity-90" />
                        {/* Frame Lines */}
                        <div className="absolute inset-4 border border-white/20 opacity-50"></div>
                        <div className="absolute bottom-2 left-1/2 -translate-x-1/2 text-[8px] text-white/40 font-mono tracking-widest">RAW</div>
                    </div>

                    {/* Shutter Area */}
                    <div className="h-20 bg-[#e4e2dd] flex items-center justify-center border-t border-white">
                         <button 
                            onClick={takePhoto}
                            disabled={isThrottled}
                            className={`w-14 h-14 rounded-full border-[3px] border-[#d6d3cd] bg-gradient-to-b from-[#fdfbf7] to-[#e4e2dd] shadow-[0_4px_10px_rgba(0,0,0,0.1)] flex items-center justify-center transition-all duration-200 ${isThrottled ? 'opacity-50 scale-95' : 'hover:scale-105 active:scale-95'}`}
                         >
                             <div className={`w-10 h-10 rounded-full ${isThrottled ? 'bg-stone-300' : 'bg-[#d64541]'} shadow-inner opacity-90`}></div>
                         </button>
                    </div>
                </div>
            </div>

            {/* SETTINGS */}
            <div className="fixed top-8 right-8 z-50">
                 <button onClick={() => setShowApiKeyModal(true)} className="w-8 h-8 rounded-full border border-stone-200 bg-white/60 backdrop-blur-sm flex items-center justify-center hover:bg-stone-800 hover:text-white transition-all"><Key size={12} /></button>
            </div>

            {/* MODAL */}
            {showApiKeyModal && (
                <div className="fixed inset-0 z-[60] flex items-center justify-center bg-[#fdfbf7]/90 backdrop-blur-sm">
                    <div className="bg-[#fdfbf7] border border-stone-200 p-12 max-w-md w-full shadow-[0_20px_50px_rgba(0,0,0,0.1)] text-center">
                        <h2 className="font-serif text-3xl mb-2 italic text-stone-800">Author Access</h2>
                        <p className="font-sans text-[9px] mb-8 uppercase tracking-widest text-stone-400">Gemini API Integration</p>
                        <input type="password" className="w-full bg-transparent border-b border-stone-300 p-3 font-serif text-lg focus:outline-none mb-8 text-center placeholder-stone-200 text-stone-600" placeholder="Enter Key" defaultValue={apiKey} onBlur={e => saveApiKey(e.target.value)} />
                        <button onClick={() => setShowApiKeyModal(false)} className="bg-stone-800 text-white px-8 py-3 font-sans text-[9px] uppercase tracking-widest hover:bg-black transition-colors">Begin Writing</button>
                    </div>
                </div>
            )}
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<React.StrictMode><App /></React.StrictMode>);
    </script>
  </body>
</html>
